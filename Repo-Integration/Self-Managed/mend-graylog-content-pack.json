{
  "v": "1",
  "id": "48cb6f04-07e2-48ab-85bc-a517715c17cf",
  "rev": 6,
  "name": "Mend Repo Integration",
  "summary": "Dashboards and Inputs for the Mend Repo Integration",
  "description": "This content pack includes the following dashboards:\n- Controller Search\n- Scanner Search\n- Remediate Search\n\nIt also includes the following healthchecks for the containers:\n- Controller Stats\n- Scanner Healthcheck\n- Remediate Healthcheck\n\nThis content pack also includes the following inputs:\n- Mend Repo Integration - Allows ingesting of logs from all repo integration containers.\n- Remediate Healthcheck - Periodically sends an API request to the Remediate healthcheck endpoint.\n- Scanner Healthcheck - Periodically sends an API request to the Scanner healthcheck endpoint.",
  "vendor": "Mend.io <ps@mend.io>",
  "url": "https://github.com/mend-toolkit/mend-examples",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "418f3eb7-7a07-42af-a363-be7041ddff0d",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Search for Controller Container Logs"
        },
        "search": {
          "queries": [
            {
              "id": "34913d25-24db-4e8c-8099-915738647e99",
              "timerange": {
                "from": 86400,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "host:/wss-[a-z]*-app/ NOT \"/payload/healthcheck\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "ef24e3a1-26ce-4027-a53a-1418bb5dca3d",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "host:/wss-[a-z]*-app/ NOT \"/payload/healthcheck\" NOT \"/payload/scanner/request\""
                  },
                  "name": null,
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "offset": 0,
                  "streams": [],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "id": "6018c57d-dfd9-4541-99ea-da11b97dad70",
                  "limit": 150,
                  "filters": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2024-06-28T20:31:58.042Z"
        },
        "created_at": "2023-12-13T05:17:08.365Z",
        "requires": {},
        "state": {
          "34913d25-24db-4e8c-8099-915738647e99": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "793bb2f2-457c-4d24-8b6e-a6aaf976e179": "Message Count",
                "302e9eba-3e1c-43a2-9935-dd1b1e23a7cf": "All Messages"
              },
              "tab": {
                "title": "Controller Search"
              }
            },
            "widgets": [
              {
                "id": "302e9eba-3e1c-43a2-9935-dd1b1e23a7cf",
                "type": "messages",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "host:/wss-[a-z]*-app/ NOT \"/payload/healthcheck\" NOT \"/payload/scanner/request\""
                },
                "streams": [],
                "config": {
                  "fields": [
                    "timestamp",
                    "host",
                    "log_level",
                    "log_logger",
                    "ctx",
                    "message"
                  ],
                  "show_message_row": false,
                  "show_summary": false,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "793bb2f2-457c-4d24-8b6e-a6aaf976e179",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "host:/wss-[a-z]*-app/ NOT \"/payload/healthcheck\""
                },
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "302e9eba-3e1c-43a2-9935-dd1b1e23a7cf": [
                "6018c57d-dfd9-4541-99ea-da11b97dad70"
              ],
              "793bb2f2-457c-4d24-8b6e-a6aaf976e179": [
                "ef24e3a1-26ce-4027-a53a-1418bb5dca3d"
              ]
            },
            "positions": {
              "793bb2f2-457c-4d24-8b6e-a6aaf976e179": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": "Infinity"
              },
              "302e9eba-3e1c-43a2-9935-dd1b1e23a7cf": {
                "col": 1,
                "row": 3,
                "height": 6,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Controller Search"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "7b202b3c-26d0-4faf-ab6c-4f44def07ba6",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Remediate Search"
        },
        "search": {
          "queries": [
            {
              "id": "3b485139-9f69-40e9-a7e8-11d303f35ec9",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "host:\"remediate-server\""
                  },
                  "name": null,
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "offset": 0,
                  "streams": [],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "id": "3dee2603-287d-45b9-90d4-d93687fa93c3",
                  "limit": 150,
                  "filters": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "host:\"remediate-server\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "f98e651d-5bc9-4828-913b-3ef3d7aa028b",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2023-12-15T00:14:54.251Z"
        },
        "created_at": "2023-12-13T07:56:59.701Z",
        "requires": {},
        "state": {
          "3b485139-9f69-40e9-a7e8-11d303f35ec9": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "da7c384f-ef2a-428d-a0d6-a49e829adc82": "Message Count",
                "d1a88f0b-fd8c-4763-87e1-7ac8d3df1100": "All Messages"
              },
              "tab": {
                "title": "Remediate Search"
              }
            },
            "widgets": [
              {
                "id": "da7c384f-ef2a-428d-a0d6-a49e829adc82",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "host:\"remediate-server\""
                },
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "d1a88f0b-fd8c-4763-87e1-7ac8d3df1100",
                "type": "messages",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "host:\"remediate-server\""
                },
                "streams": [],
                "config": {
                  "fields": [
                    "timestamp",
                    "host",
                    "hostname",
                    "logContext",
                    "repository",
                    "msg",
                    "reason",
                    "result"
                  ],
                  "show_message_row": false,
                  "show_summary": false,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "time",
                      "direction": "Descending"
                    }
                  ]
                }
              }
            ],
            "widget_mapping": {
              "da7c384f-ef2a-428d-a0d6-a49e829adc82": [
                "f98e651d-5bc9-4828-913b-3ef3d7aa028b"
              ],
              "d1a88f0b-fd8c-4763-87e1-7ac8d3df1100": [
                "3dee2603-287d-45b9-90d4-d93687fa93c3"
              ]
            },
            "positions": {
              "da7c384f-ef2a-428d-a0d6-a49e829adc82": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": "Infinity"
              },
              "d1a88f0b-fd8c-4763-87e1-7ac8d3df1100": {
                "col": 1,
                "row": 3,
                "height": 6,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Remediate Search"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "7f9de273-b5fc-413e-abb8-d22e2e93c61a",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Health Checks for each component"
        },
        "search": {
          "queries": [
            {
              "id": "5c8213f9-1d55-4a1e-81a4-442ea06417f6",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source: /controller_stats.*/"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "latest",
                      "id": "Memory Usage",
                      "field": "memory_usage_percentage"
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "timeunit",
                        "timeunit": "5m"
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "60858644-bfa7-4930-b627-8bf0ebf8bb0e",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source: /controller_stats.*/"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "latest",
                      "id": "CPU Usage",
                      "field": "cpu_usage_percentage"
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "timeunit",
                        "timeunit": "5m"
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "c47d22ee-a465-4d9f-912e-7ba1476bdeba",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "host:/wss-[a-z]{3}-app/ AND \"/payload/healthcheck\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "timeunit",
                        "timeunit": "5m"
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "0b00abea-adb5-4548-b2d7-2c0e0385dd1a",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "name": "events",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source: /controller_stats.*/"
                  },
                  "streams": [],
                  "id": "8524e548-aa1f-48bb-a93b-192f2f8f9552",
                  "type": "events",
                  "filter": null,
                  "filters": []
                }
              ]
            },
            {
              "id": "11f0d10b-ec64-4861-b650-780ed0e121a7",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:\"wss-scanner-healthcheck\" AND _exists_:scanner_version"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "latest",
                      "id": "Seconds Since Last Scan Request",
                      "field": "seconds_since_last_scan_request_numerical"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "timeunit",
                        "timeunit": "5m"
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "e48cb1ac-4108-432f-bc97-da3c10b127be",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:\"wss-scanner-healthcheck\" AND _exists_:scanner_version"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "latest",
                      "id": "Memory Usage",
                      "field": "memory_usage_numerical"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "timeunit",
                        "timeunit": "5m"
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "676ef888-3c9f-4676-baa0-2d4f21820ba2",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:\"wss-scanner-healthcheck\" AND _exists_:scanner_version"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "latest",
                      "id": "Last Seen",
                      "field": "timestamp"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "scanner_version"
                      ],
                      "limit": 15,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "id": "8c4d51a9-4625-4270-9b87-40fb0b97c26b",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:\"scan_requests_in_queue\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "avg",
                      "id": "avg(pending_requests)",
                      "field": "pending_requests"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "timeunit",
                        "timeunit": "5m"
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "086d3e58-0e2b-4d06-bdb7-f24c02d53247",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            },
            {
              "id": "6651b868-5fbe-4a4f-8510-9595077aec50",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:\"remediate-healthcheck\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "timeunit",
                        "timeunit": "5m"
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "f6ada02e-382a-4217-98ea-201e9bff5fe7",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2024-06-30T04:38:25.104Z"
        },
        "created_at": "2023-12-14T23:53:38.967Z",
        "requires": {},
        "state": {
          "5c8213f9-1d55-4a1e-81a4-442ea06417f6": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Controller"
              },
              "widget": {
                "0288fe92-1e4d-4336-af84-0308f187cd2c": "Health Check Responses over time"
              }
            },
            "widgets": [
              {
                "id": "6d10f99d-5f2a-4e9b-b3cb-24369c224f7f",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source: /controller_stats.*/"
                },
                "streams": [],
                "config": {
                  "visualization": "line",
                  "column_limit": 15,
                  "event_annotation": true,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "timeunit",
                          "value": 5,
                          "unit": "minutes"
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "CPU Usage"
                      },
                      "function": "latest(cpu_usage_percentage)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "ef263e70-bbe5-48f2-8481-afe34a91b7b4",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source: /controller_stats.*/"
                },
                "streams": [],
                "config": {
                  "visualization": "line",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "timeunit",
                          "value": 5,
                          "unit": "minutes"
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Memory Usage"
                      },
                      "function": "latest(memory_usage_percentage)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "0288fe92-1e4d-4336-af84-0308f187cd2c",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "host:/wss-[a-z]{3}-app/ AND \"/payload/healthcheck\""
                },
                "streams": [],
                "config": {
                  "visualization": "line",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "timeunit",
                          "value": 5,
                          "unit": "minutes"
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "ef263e70-bbe5-48f2-8481-afe34a91b7b4": [
                "60858644-bfa7-4930-b627-8bf0ebf8bb0e"
              ],
              "0288fe92-1e4d-4336-af84-0308f187cd2c": [
                "0b00abea-adb5-4548-b2d7-2c0e0385dd1a"
              ],
              "6d10f99d-5f2a-4e9b-b3cb-24369c224f7f": [
                "c47d22ee-a465-4d9f-912e-7ba1476bdeba",
                "8524e548-aa1f-48bb-a93b-192f2f8f9552"
              ]
            },
            "positions": {
              "ef263e70-bbe5-48f2-8481-afe34a91b7b4": {
                "col": 5,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "0288fe92-1e4d-4336-af84-0308f187cd2c": {
                "col": 1,
                "row": 5,
                "height": 3,
                "width": "Infinity"
              },
              "6d10f99d-5f2a-4e9b-b3cb-24369c224f7f": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 4
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "11f0d10b-ec64-4861-b650-780ed0e121a7": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Scanner"
              },
              "widget": {
                "27a452a3-c524-421a-ac04-2f42f79419ec": "Average Seconds Since Last Scan Request",
                "e0568156-a33b-4a4f-b845-cafcc433b227": "Average Memory Usage over Time",
                "2970bb38-6e3f-4249-aecf-bdbd5cd356e6": "Scanner Versions",
                "7d55f11a-508b-45af-a21e-8dfde1ce9afa": "Average Requests in Queue"
              }
            },
            "widgets": [
              {
                "id": "27a452a3-c524-421a-ac04-2f42f79419ec",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source:\"wss-scanner-healthcheck\" AND _exists_:scanner_version"
                },
                "streams": [],
                "config": {
                  "visualization": "line",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "timeunit",
                          "value": 5,
                          "unit": "minutes"
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Seconds Since Last Scan Request"
                      },
                      "function": "latest(seconds_since_last_scan_request_numerical)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "e0568156-a33b-4a4f-b845-cafcc433b227",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source:\"wss-scanner-healthcheck\" AND _exists_:scanner_version"
                },
                "streams": [],
                "config": {
                  "visualization": "line",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "timeunit",
                          "value": 5,
                          "unit": "minutes"
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Memory Usage"
                      },
                      "function": "latest(memory_usage_numerical)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "2970bb38-6e3f-4249-aecf-bdbd5cd356e6",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source:\"wss-scanner-healthcheck\" AND _exists_:scanner_version"
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "scanner_version"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Last Seen"
                      },
                      "function": "latest(timestamp)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "7d55f11a-508b-45af-a21e-8dfde1ce9afa",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source:\"scan_requests_in_queue\""
                },
                "streams": [],
                "config": {
                  "visualization": "line",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "timeunit",
                          "value": 5,
                          "unit": "minutes"
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "avg(pending_requests)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "27a452a3-c524-421a-ac04-2f42f79419ec": [
                "e48cb1ac-4108-432f-bc97-da3c10b127be"
              ],
              "e0568156-a33b-4a4f-b845-cafcc433b227": [
                "676ef888-3c9f-4676-baa0-2d4f21820ba2"
              ],
              "2970bb38-6e3f-4249-aecf-bdbd5cd356e6": [
                "8c4d51a9-4625-4270-9b87-40fb0b97c26b"
              ],
              "7d55f11a-508b-45af-a21e-8dfde1ce9afa": [
                "086d3e58-0e2b-4d06-bdb7-f24c02d53247"
              ]
            },
            "positions": {
              "e0568156-a33b-4a4f-b845-cafcc433b227": {
                "col": 5,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "27a452a3-c524-421a-ac04-2f42f79419ec": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "2970bb38-6e3f-4249-aecf-bdbd5cd356e6": {
                "col": 9,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "7d55f11a-508b-45af-a21e-8dfde1ce9afa": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": 4
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "6651b868-5fbe-4a4f-8510-9595077aec50": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Remediate"
              },
              "widget": {
                "837b710a-0df9-4b5e-a43e-ff43f943506a": "Healthcheck Requests over Time"
              }
            },
            "widgets": [
              {
                "id": "837b710a-0df9-4b5e-a43e-ff43f943506a",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source:\"remediate-healthcheck\""
                },
                "streams": [],
                "config": {
                  "visualization": "line",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "timeunit",
                          "value": 5,
                          "unit": "minutes"
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "837b710a-0df9-4b5e-a43e-ff43f943506a": [
                "f6ada02e-382a-4217-98ea-201e9bff5fe7"
              ]
            },
            "positions": {
              "837b710a-0df9-4b5e-a43e-ff43f943506a": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 4
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Healthchecks"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "6a175690-7189-46a8-864f-475a039e49cb",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Search WSS Scanner logs"
        },
        "search": {
          "queries": [
            {
              "id": "2156323c-da72-49f8-a215-48908647cdda",
              "timerange": {
                "from": 3600,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "host:\"wss-scanner\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "03982e5e-4073-45d9-b046-c5cb5b28b881",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "host:\"wss-scanner\""
                  },
                  "name": null,
                  "timerange": {
                    "from": 28800,
                    "type": "relative"
                  },
                  "offset": 0,
                  "streams": [],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "id": "548c741b-fa43-4619-b81b-c2480bdf93db",
                  "limit": 150,
                  "filters": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2023-12-15T00:15:24.139Z"
        },
        "created_at": "2023-12-13T04:53:31.817Z",
        "requires": {},
        "state": {
          "2156323c-da72-49f8-a215-48908647cdda": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "cbc486e7-b5be-4075-bc6c-e9b487756ac0": "Message Count",
                "5e4a8a0f-2738-4f13-ade5-f673d6b07430": "All Messages"
              },
              "tab": {
                "title": "Scanner Search"
              }
            },
            "widgets": [
              {
                "id": "5e4a8a0f-2738-4f13-ade5-f673d6b07430",
                "type": "messages",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "host:\"wss-scanner\""
                },
                "streams": [],
                "config": {
                  "fields": [
                    "host",
                    "timestamp",
                    "log_level",
                    "ctx",
                    "message"
                  ],
                  "show_message_row": false,
                  "show_summary": false,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "cbc486e7-b5be-4075-bc6c-e9b487756ac0",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 28800,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "host:\"wss-scanner\""
                },
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "5e4a8a0f-2738-4f13-ade5-f673d6b07430": [
                "548c741b-fa43-4619-b81b-c2480bdf93db"
              ],
              "cbc486e7-b5be-4075-bc6c-e9b487756ac0": [
                "03982e5e-4073-45d9-b046-c5cb5b28b881"
              ]
            },
            "positions": {
              "5e4a8a0f-2738-4f13-ade5-f673d6b07430": {
                "col": 1,
                "row": 3,
                "height": 6,
                "width": "Infinity"
              },
              "cbc486e7-b5be-4075-bc6c-e9b487756ac0": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Scanner Search"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "26086a6b-158f-44d0-875f-05b8bdf3833f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Controller Stats"
        },
        "configuration": {
          "target_url": {
            "@type": "string",
            "@value": "http://host.docker.internal:2375/containers/wss-ghe-app/stats?stream=false"
          },
          "path": {
            "@type": "string",
            "@value": "$"
          },
          "interval": {
            "@type": "integer",
            "@value": 10
          },
          "headers": {
            "@type": "string",
            "@value": ""
          },
          "throttling_allowed": {
            "@type": "boolean",
            "@value": false
          },
          "timeunit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "enable_flattening": {
            "@type": "boolean",
            "@value": false
          },
          "source": {
            "@type": "string",
            "@value": "controller_stats"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.misc.jsonpath.JsonPathInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "b1111773-1ddf-4c45-b18f-bde6641fccbe",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Scanner Stats"
        },
        "configuration": {
          "target_url": {
            "@type": "string",
            "@value": "http://host.docker.internal:2375/containers/wss-scanner/stats?stream=false"
          },
          "path": {
            "@type": "string",
            "@value": "$"
          },
          "interval": {
            "@type": "integer",
            "@value": 10
          },
          "headers": {
            "@type": "string",
            "@value": ""
          },
          "throttling_allowed": {
            "@type": "boolean",
            "@value": false
          },
          "timeunit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "enable_flattening": {
            "@type": "boolean",
            "@value": false
          },
          "source": {
            "@type": "string",
            "@value": "scanner_stats"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.misc.jsonpath.JsonPathInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "48c950fb-c370-4d2f-a68c-0a002b60b50b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Scanner HealthCheck"
        },
        "configuration": {
          "target_url": {
            "@type": "string",
            "@value": "http://host.docker.internal:9393/health-check"
          },
          "path": {
            "@type": "string",
            "@value": "$"
          },
          "interval": {
            "@type": "integer",
            "@value": 15
          },
          "headers": {
            "@type": "string",
            "@value": "Accept: application/json"
          },
          "throttling_allowed": {
            "@type": "boolean",
            "@value": false
          },
          "timeunit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "enable_flattening": {
            "@type": "boolean",
            "@value": false
          },
          "source": {
            "@type": "string",
            "@value": "wss-scanner-healthcheck"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.misc.jsonpath.JsonPathInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": [
          {
            "target_field": {
              "@type": "string",
              "@value": "scanner_version"
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "Scanner Version=([\\d\\.]+),"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "result"
            },
            "title": {
              "@type": "string",
              "@value": "Scanner Version"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "max_heap_size_mb"
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "NUMERIC"
                },
                "configuration": {}
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "maxHeapSizeMB=([\\d]+),"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "result"
            },
            "title": {
              "@type": "string",
              "@value": "maxHeapSizeMB"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "memory_usage_numerical"
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "NUMERIC"
                },
                "configuration": {}
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "Memory Usage=([\\d]+),"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "result"
            },
            "title": {
              "@type": "string",
              "@value": "Memory Usage"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "seconds_since_last_scan_request_numerical"
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "NUMERIC"
                },
                "configuration": {}
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "Seconds Since Last Scan Request=([\\d]+)"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "result"
            },
            "title": {
              "@type": "string",
              "@value": "Seconds Since Last Scan Request"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "04d255da-aa37-4e07-84bd-6a6062289425",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Remediate Healthcheck"
        },
        "configuration": {
          "target_url": {
            "@type": "string",
            "@value": "http://host.docker.internal:8582"
          },
          "path": {
            "@type": "string",
            "@value": "$"
          },
          "interval": {
            "@type": "integer",
            "@value": 15
          },
          "headers": {
            "@type": "string",
            "@value": "Accept: application/json"
          },
          "throttling_allowed": {
            "@type": "boolean",
            "@value": false
          },
          "timeunit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "enable_flattening": {
            "@type": "boolean",
            "@value": false
          },
          "source": {
            "@type": "string",
            "@value": "remediate-healthcheck"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.misc.jsonpath.JsonPathInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "4337947b-9563-4b0f-8355-ed079097abcd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Mend Repo Integration"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5140
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": [
          {
            "target_field": {
              "@type": "string",
              "@value": "host"
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^(wss\\-scanner|wss\\-[a-z]{3}\\-app|remediate-server)\\[[\\d]+\\]\\:"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "Host"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "CUT"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "message"
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^.*?:\\s+(.*)"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "Message Extractor (Remove Source from message)"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": ""
            },
            "condition_value": {
              "@type": "string",
              "@value": "^\\{"
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "list_separator": {
                "@type": "string",
                "@value": ", "
              },
              "kv_separator": {
                "@type": "string",
                "@value": "="
              },
              "key_prefix": {
                "@type": "string",
                "@value": ""
              },
              "key_separator": {
                "@type": "string",
                "@value": "_"
              },
              "replace_key_whitespace": {
                "@type": "boolean",
                "@value": false
              },
              "key_whitespace_replacement": {
                "@type": "string",
                "@value": "_"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "JSON Extractor"
            },
            "type": {
              "@type": "string",
              "@value": "JSON"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "REGEX"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": "ctx"
            },
            "condition_value": {
              "@type": "string",
              "@value": "CTX"
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "^\\[CTX=([0-9a-f]+)"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "Extract CTX"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "STRING"
            }
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "d774f60f-a570-4e87-96ff-7900ab97eeae",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Scan Requests in Queue"
        },
        "configuration": {
          "target_url": {
            "@type": "string",
            "@value": "http://host.docker.internal:5678/payload/scanner/request"
          },
          "path": {
            "@type": "string",
            "@value": "$"
          },
          "interval": {
            "@type": "integer",
            "@value": 1
          },
          "headers": {
            "@type": "string",
            "@value": ""
          },
          "throttling_allowed": {
            "@type": "boolean",
            "@value": false
          },
          "timeunit": {
            "@type": "string",
            "@value": "MINUTES"
          },
          "enable_flattening": {
            "@type": "boolean",
            "@value": false
          },
          "source": {
            "@type": "string",
            "@value": "scan_requests_in_queue"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          }
        },
        "static_fields": {
          "source": {
            "@type": "string",
            "@value": "scan_requests_in_queue"
          }
        },
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.misc.jsonpath.JsonPathInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": [
          {
            "target_field": {
              "@type": "string",
              "@value": "pending_requests"
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [
              {
                "type": {
                  "@type": "string",
                  "@value": "NUMERIC"
                },
                "configuration": {}
              }
            ],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "requestsCount=([0-9]+)"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "result"
            },
            "title": {
              "@type": "string",
              "@value": "Current Pending Requests"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "04cbca42-3b3f-4389-baef-45a32fb1bde1",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Controller CPU Usage"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Controller CPU Usage\"\nstage 0 match either\nrule \"Calculate Controller Used Memory\"\nrule \"Calculate Controller Used CPU\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "18c69ed6-026e-407e-9d79-2253cda726bd"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c79b1d84-628d-4d4b-95b1-6b824aaf5b26",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Calculate Controller Used Memory"
        },
        "description": {
          "@type": "string",
          "@value": "Calculate Controller Memory"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Calculate Controller Used Memory\"\nwhen\n    true\nthen\n    let current_message = to_string($message.result);\n    let memory_usage = regex(\"memory_stats.*?usage=(\\\\d+)\", current_message)[\"0\"];\n    let memory_limit = regex(\"memory_stats.*?limit=(\\\\d+)\", current_message)[\"0\"];\n    \n    let memory_usage_percentage = (to_double(memory_usage) / to_double(memory_limit)) * 100.0;\n    \n    set_field(\"memory_usage_percentage\", to_double(memory_usage_percentage));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "9ce57b12-90e1-4436-b2f2-59ffcbe892f4",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Calculate Controller Used CPU"
        },
        "description": {
          "@type": "string",
          "@value": "Calculate Controller CPU Usage"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Calculate Controller Used CPU\"\nwhen\n    true\nthen\n    let current_message = to_string($message.result);\n    let cpu_total_usage = regex(\"cpu_stats.*?cpu_usage.*?total_usage=(\\\\d+)\", current_message)[\"0\"];\n    let system_cpu_usage = regex(\"cpu_stats.*?cpu_usage.*?system_cpu_usage=(\\\\d+)\", current_message)[\"0\"];\n    let num_cpus = regex(\"cpu_stats.*?online_cpus=(\\\\d+)\", current_message)[\"0\"];\n    \n    let precpu_total_usage = regex(\"precpu_stats.*?cpu_usage.*?total_usage=(\\\\d+)\", current_message)[\"0\"];\n    let system_precpu_usage = regex(\"precpu_stats.*?cpu_usage.*?system_cpu_usage=(\\\\d+)\", current_message)[\"0\"];\n    \n    let cpu_delta = to_double(cpu_total_usage) - to_double(precpu_total_usage);\n    let system_cpu_delta = to_double(system_cpu_usage) - to_double(system_precpu_usage);\n    \n    let cpu_usage_percentage = (to_double(cpu_delta) / to_double(system_cpu_delta)) * to_double(num_cpus) * 100.0;\n    \n    set_field(\"cpu_usage_percentage\", to_double(cpu_usage_percentage));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "18c69ed6-026e-407e-9d79-2253cda726bd",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "Stats"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "source"
            },
            "value": {
              "@type": "string",
              "@value": "controller_stats"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          },
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "source"
            },
            "value": {
              "@type": "string",
              "@value": "scanner_stats"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "OR"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "e30588c6-33b1-4242-a234-7a8dd93c6a1b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "All events"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "65bb4994-32a2-4501-a33e-608a05dea203",
      "data": {
        "title": {
          "@type": "string",
          "@value": "All system events"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.8+8e06d22"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "url_whitelist_entry",
        "version": "1"
      },
      "id": "2156a429-5dc2-4a14-a4d9-b682e951234f",
      "data": {
        "id": "cb0a3295-a8d8-416a-8957-3d8554b84107",
        "type": "regex",
        "title": "Controller Stats",
        "value": "^\\Qhttp://host.docker.internal:2375/containers/wss-ghe-app/stats?stream=false\\E$"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.1.3"
        }
      ]
    }
  ]
}
